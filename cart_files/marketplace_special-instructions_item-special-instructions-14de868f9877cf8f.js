"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2709],{489791:function(e,n,a){a.d(n,{Y:function(){return H}});var l={};a.r(l),a.d(l,{Add:function(){return L},AddInstructions:function(){return C},Edit:function(){return h},EditInstructions:function(){return F},Save:function(){return I},dontAddSpecialChars:function(){return M},ghostText:function(){return E},instructionLabel:function(){return V},modalContent:function(){return P},specialRequestLabel:function(){return S}});var t=a(247687),r=a(768230),i=a(954568),s=a(702802),o=a(262430),d=a(760612),c=a(890003),u=a(168796),m=a(512142);const p={type:"mutation",name:"updateItemInstructions",hash:"187ee7e9a2de08f47bb5daa2674413f462fff8eaa5f45555671f9c88d8b6e5ea"};var x=a(734881),b=a(64109),y=a(371212),g=a(569640);var w=a(167439),A=a(677543),f=a(689221),v=a(969538);const S=()=>"Include a special request",E=()=>"Please write 'Happy birthday Mom!\" with a heart next to it",L=()=>"Add",h=()=>"Edit",C=()=>"Add instructions",F=()=>"Edit instructions",I=()=>"Save",P=()=>"Add a custom message or special request for the store. The store will do its best to accommodate you.",V=()=>"Your message or request",M=()=>"Do not write special characters (ex: @?&)";var j=a(194131),R=a(147507),T=a(22769),O=a(324523),D=a.n(O),k=a(372448),_=a(248484);const z=e=>{let{message:n="",onAddEditAction:a,actionStyleFlag:r=!0,analyticsContext:i="productPage",mpdModuleLinkExtras:s,isBYOD:o}=e;const{isMobile:d}=(0,j.vP)(),c=(0,_.WCA)(),u=(0,_.e0r)(),m=(0,_.S77)(),p=""===n?"Add":"Edit",x=o?"deliveryFromLocalStoreBYOD":"deliveryFromLocalStore",b="shoppingCart"===i?{co:{ty:x,id:x,nm:x}}:"productPage"===i?{li:{aa:{byod:o?1:0,seid:c,id:m,us:u}}}:{};return(0,t.jsx)(k.ZP,{name:"specialRequest",moduleContext:i,moduleLinkExtras:s,children:(0,t.jsxs)("div",{className:D()("f6 flex flex-row w-100 items-center pv3 mb3",{ph3:d&&r}),children:[(0,t.jsxs)("div",{className:D()("flex flex-column",{"w-90":!r}),children:[(0,t.jsxs)("div",{className:D()("flex w-100 b",{mt2:!d}),children:[(0,t.jsx)(T.J,{className:"mr2 mt1 ml0",name:"Note","aria-hidden":"true"})," ",(0,f.m)(l,"specialRequestLabel")]}),""!==n&&(0,t.jsx)("div",{className:"ml4 f6","data-testid":"special-request-message",children:n})]}),(0,t.jsx)(R.Z,{variant:"tertiary",className:D()("f6 mb0 lh-title dark-gray f6 ml3 mt1 f5-l pa0",{mt4:""!==n,"ml-auto":!r}),onClick:a,"aria-label":(0,f.m)(l,"".concat(p,"Instructions")),onLinkName:"".concat(p.toLocaleLowerCase(),"SpecialRequestClick"),"data-testid":"".concat(p,"-special-request"),onLinkExtras:b,children:(0,f.m)(l,p)})]})})};var N=a(259480),q=a(217091),G=a(15547),W=a(679670),B=a(410904),U=a(528775),Y=a(285777);const X=e=>{let{isOpen:n,isLoading:a,isError:r,errorMessage:i,onClose:o,onSave:d,title:c,instructionsMessage:u,instructionsLength:m=100,setInstructions:p,analyticsContext:x="productPage"}=e;var b;const y=(0,s.iC)(Y.w),{enableItemCommentValidation:g}=(null===y||void 0===y||null===(b=y.marketplace)||void 0===b?void 0:b.values)||{},{isMobile:w}=(0,j.vP)(),{0:A,1:S}=(0,v.useState)(u),{0:E,1:L}=(0,v.useState)(""),h={co:{tx:A,ov:"specialRequest"}};(0,v.useEffect)(()=>{S(u)},[u,n]);return(0,t.jsx)(k.ZP,{name:"specialRequest",moduleContext:x,children:(0,t.jsx)(W.Z,{title:c,isOpen:n,onClose:o,size:"medium",onLinkName:"close",onLinkExtras:{co:{ov:"specialRequest",tx:A}},onLinkExtrasForClose:{co:{ov:"specialRequest"},li:{tx:A}},children:(0,t.jsx)(q.tp,{context:x,action:"overlayView",name:"specialRequest",payload:h,children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:D()({"mt2 mb7":w}),children:[r&&(0,t.jsx)("div",{className:"mb3",children:(0,t.jsx)(G.Z,{variant:"error",role:"alert",children:i||N.lQ})}),(0,t.jsxs)("div",{className:"flex-column",children:[(0,t.jsx)("div",{className:"f5 lh-copy mb3 dark-gray",children:(0,f.m)(l,"modalContent")}),(0,t.jsx)(U.Z,{label:"".concat((0,f.m)(l,"instructionLabel")),onChange:e=>{var n;S(e.target.value),g&&(n=e.target.value).length>0&&!/^\w[\w\s.,]*$/u.test(n)?L((0,f.m)(l,"dontAddSpecialChars")):L("")},maxLength:m,size:"large",placeholder:(0,f.m)(l,"ghostText"),value:A,error:E})]})]}),(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsx)(R.Z,{variant:"primary",className:"h4 f5 w-100 mt3",size:"medium",onClick:()=>{if(0===E.length){const e=A.trim();p(e),d(e)}},"aria-label":(0,f.m)(l,"Save"),onLinkName:"saveClick","data-testid":"save-special-request",onLinkExtras:{co:{ov:"specialRequest"},li:{tx:A}},children:a?(0,t.jsx)(B.$,{color:"white",size:"small"}):(0,f.m)(l,"Save")})})]})})})})},H=e=>{let{moduleConfigsData:n,lineItem:a,handleOnSaveWithoutUpdate:S,actionStyleFlag:E,analyticsContext:L="productPage",offerId:h,mpdModuleLinkExtras:C,isBYOD:F}=e;const{setSpecialInstructionsText:I}=(0,A.N)(),P=(null===n||void 0===n?void 0:n.requestText)||(0,f.m)(l,"specialRequestLabel"),V=(null===n||void 0===n?void 0:n.messageLength)?parseInt(null===n||void 0===n?void 0:n.messageLength,10):100,{0:M,1:j}=(0,v.useState)(""),{0:R,1:T}=(0,v.useState)(!1),{0:O,1:D}=(0,v.useState)(!1),k=(0,r.wh)(),_=null!==a&&void 0!==a?a:k.find(e=>e.product.offerId===h),{personalizedItemDetails:N}=null!==_&&void 0!==_?_:{},q=null===N||void 0===N?void 0:N.editableInstructionAttributes,G=(0,r.cF)(),W=(0,s.iC)(i.Tg,m.YL),{enableVisionItems:B,enableFulfillmentMajorAppliances:U,enableBYOD:Y,enablePromiseDateRange:H}=W.cart.values,{enablePetRxManualRefill:Q,enableItemLevelCheckout:Z}=W.shared.values,[J,{isLoading:$}]=(()=>{const e=(0,s.iC)(i.Tg,m.YL),[n]=(0,g.t)(),{enableAEBadge:a,enableQueueing:l,enablePartialSwitchModuleLevel:t,enableACCScheduling:r,enableCartBookslotShortcut:w,enableWplusCashback:A,enableBenefitSavings:f,enablePickupNotAvailable:v,enableReturnsLabel:S,enableStarRatings:E,enableClipRewards:L,enableI18n:h,enableWplusPetBenefit:C,enableGenericWalmartCash:F,enableOrderCutOffTimeInline:I,enableHotCartFeature:P,enableDroneDelivery:V,enableSuggestedSlotAvailability:M,enablePFS:j,enableACCVariant:R,enablePromoDiscount:T,enableFulfillmentChoice:O,enableAvailableFinancingOptions:D,enableFreeDeliveryThreshold:k,enableShippingOptions:_,enableShippingFeeClarity:z,enableAccQuantityNudge:N,enableFeeThresholdBar:q,enableSignatureOnDelivery:G,enableColdChainExpansion:W,enableMaximumThreshold:B,enableLatLonForAddress:U,enableUnscheduledPickup:Y,enableItemDeliveryPrice:X,enableStreamlinedBadges:H,enableRemoveAvailabilityStatus:Q,enableFIGCartFulfillmentOption:Z,enableExpressReservationEndTime:J,enablePriceDetailsSavings:$,enableAccFourTiresNudge:K,enableItemTypeAttributes:ee,enablePromotionalMetaData:ne,enableEligibleCareplans:ae,enableShowACCSchedulingInCart:le,enableAOSLineItemId:te,enableStaticMessageType:re,enableAOSPriceChangeExp:ie,enablePayForSpeed:se,enableCheckoutableErrorAttributes:oe,enableFlowerDelivery:de,enableExpressStoreBadge:ce,enableAllowItemQtyEditable:ue,enableAllowItemRemoval:me,enableAllowSaveForLaterForItem:pe,enableVPForACCItems:xe}=e.cart.values,{enableExpressSla:be,enableWeeklyReservationCartBookslot:ye,enableBadges:ge,enableWalmartPlusFreeDiscountedExpress:we,enableHolidayFreeExpressDelivery:Ae,enableMsiMci:fe,enableSpendLimit:ve,enableTaxBreakdown:Se,enablePetRxManualRefill:Ee,enableItemLevelCheckout:Le,enableDigitalRewards:he,enableSubscriptionsInTransaction:Ce,enableMCSEOptimization:Fe,enableSubscribeToSaveNudge:Ie,enableSubscriptionDiscounts:Pe,enableWplusACCPayForServiceOnline:Ve,enableExpandedGiftingEligibility:Me,enableMOQ:je,enableWFSGlobal:Re,enableMaxItemAllowedForRegularSlot:Te,enableWic:Oe,enableGEP:De,enableWplusPhoneRecyclingPrevention:ke,enableWplusBuyNowPhoneRecyclingPrevention:_e,enableRxpd:ze,enableSellerFeeBreakdown:Ne,enableE2EPickupEnhancement:qe,enable3pEGiftCardPersonalization:Ge,enableAppleCareFreeTrials:We,enablePaymentMethodPromotion:Be,enableAOSRearchitect:Ue,enableAOSModuleAttribute:Ye,enableShowSavingsGrandTotal:Xe,enableCCAFlow:He,enableVolumePricing:Qe,enableTireInstallationWithFitment:Ze,enableDestinationTax:Je,enableSubscriptionsInTransactionDiscount:$e,enableEachWeightItem:Ke,enableOutOfCountry:en,enableSpecialOrderMultiline:nn}=e.shared.values,an=(0,b.i)(),{onCartUpdate:ln}=(0,y.er)(),tn=(0,d.Zq)(),rn=(0,c.Z)().getGqlFetch("cecxo");return(0,u.D)(e=>rn(p,{...e,input:{...e.input},includePartialFulfillmentSwitching:t,enableAEBadge:a,enableBadges:ge,includeExpressSla:be,includeQueueing:l,enableWeeklyReservationCartBookslot:ye,enableCartBookslotShortcut:w,enableACCScheduling:r,enableWalmartPlusFreeDiscountedExpress:we,enableDiscountedOrHolidayExpress:we||Ae,enableBenefitSavings:f,enableUnifiedBadges:an,enablePickupNotAvailable:v,enableReturnsLabel:S,enableStarRatings:E,enableSpendLimit:ve,enableMsiMci:fe,enableClipRewards:L,enableTaxBreakdown:Se,enableI18nWave1:(0,x.Xd)(h),enableWplusPetBenefit:C,enableCartLevelPromotions:A||C||F||he,enableOrderCutOffTime:I||G,enableHotCartFeature:P,enableRxpd:ze,enableDroneDelivery:V,enableMOQ:je,enablePetRxManualRefill:Ee,enableItemLevelCheckout:Le,enableSuggestedSlotAvailability:M,enableE2EPickupEnhancement:qe,enablePFS:j&&1===R,enableSubscriptionsInTransaction:Ce,enableSubscribeToSaveNudge:Ie,enableSubscriptionDiscounts:Pe,enablePromoDiscount:T,enableWplusACCPayForServiceOnline:Ve,includeItemPackaging:Me,enableWFSGlobal:Re,includeFulfillmentSwitchOptions:O,enableMaxItemAllowedForRegularSlot:Te,enableAvailableFinancingOptions:D,enableFreeDeliveryThreshold:k,enableShippingOptions:_,enableShippingFeeClarity:z,getPriceInfoDetails:z||N||ze,enableAccQuantityNudge:N||K,enableFeeThresholdBar:q,enableWic:Oe,enableColdChainExpansion:W,enableGEP:De,enableIsEligibleForFreeTrialV1:ke||_e,enableMaximumThreshold:B,enableSellerFeeBreakdown:Ne,enable3pEGiftCardPersonalization:Ge,enableAppleCareFreeTrials:We,enableAOSRearchitect:Ue,enableAOSModuleAttribute:Ye,enableLatLonForAddress:U,enablePaymentMethodPromotion:Be,enableUnscheduledPickup:Y,enableUnscheduledShippingOptions:Y&&_,enableItemDeliveryPrice:X,enableShowSavingsGrandTotal:Xe,enableCCAFlow:He,enableVolumePricing:Qe,enableStreamlinedBadges:H,enableRemoveAvailabilityStatus:Q,enableFIGCartFulfillmentOption:Z,enableExpressReservationEndTime:J,subscriptionInTransactionAndDetailed:!Fe&&Ce,enablePriceDetailsSavings:$,enableItemTypeAttributes:ee,includeFitment:Ze,enablePromotionalMetaData:ne,enableEligibleCareplans:ae,enableShowACCSchedulingInCart:le,enableAOSLineItemId:te,enableDestinationTax:Je,enableSubscriptionsInTransactionDiscount:$e,enableStaticMessageType:re,enableEachWeightItem:Ke,enableAOSPriceChangeExp:ie,enablePayForSpeed:se,enableCheckoutableErrorAttributes:oe,enableFlowerDelivery:de,enableOutOfCountry:en,enableExpressStoreBadge:ce,enableAllowItemQtyEditable:ue,enableAllowItemRemoval:me,enableAllowSaveForLaterForItem:pe,enableVPForACCItems:xe,enableSpecialOrderMultiline:nn}),{onError:(e,n)=>{(0,o.cM)(["error","cart","update_item_instructions_from_cart","update item instructions mutation failure"],{type:"log",message:e})},onSuccess:(e,a)=>{var l;if((null===e||void 0===e||null===(l=e.errors)||void 0===l?void 0:l.length)&&!n(e.errors)){var t;(0,o.cM)(["error","cart","update_item_instructions_error"],{type:"log",errors:e.errors,variables:a,correlationId:null===(t=e.headers)||void 0===t?void 0:t.get("x-o-correlation-id")})}else{var r;const n=null===e||void 0===e||null===(r=e.data)||void 0===r?void 0:r.updateItemInstructions,a={data:{cart:n}};tn.setQueryData(["cart-index-get-cart",{id:null===n||void 0===n?void 0:n.id}],a),ln(n)}}})})();(0,v.useEffect)(()=>{var e;(null===q||void 0===q?void 0:q.length)&&j((null===(e=null===q||void 0===q?void 0:q.filter(e=>"SPECIAL_INSTRUCTIONS"===(null===e||void 0===e?void 0:e.type))[0])||void 0===e?void 0:e.value)||"")},[q]);const K=()=>{T(!1)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(z,{message:M,onAddEditAction:()=>{T(!0)},actionStyleFlag:E,analyticsContext:L,mpdModuleLinkExtras:C,isBYOD:F}),(0,t.jsx)(X,{isOpen:R,isLoading:$,onClose:K,isError:O,onSave:async e=>{if(_&&(null===_||void 0===_?void 0:_.id)){var n;const a={cartId:G,items:[{lineItemId:null===_||void 0===_?void 0:_.id,itemInstructions:[{type:"SPECIAL_INSTRUCTIONS",value:e}]}],features:(0,w.N)({enableVisionItems:B,enablePetRxManualRefill:Q,enableItemLevelCheckout:Z,enableFulfillmentMajorAppliances:U,enableBYOD:Y,enablePromiseDateRange:H})},l=await J({input:a});(null===l||void 0===l||null===(n=l.data)||void 0===n?void 0:n.updateItemInstructions)&&!l.errors?(D(!1),K()):D(!0)}else I(e),null===S||void 0===S||S(e),K()},title:P,instructionsMessage:M,setInstructions:j,instructionsLength:V,analyticsContext:L})]})}}}]);