"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[92758],{48555:function(e,n,t){t.r(n),t.d(n,{closeBanner:function(){return u},closeDialog:function(){return L},defaultMessage:function(){return p},dialogTitle:function(){return a},dontRefresh:function(){return d},errorMessage:function(){return x},expired:function(){return C},hangOn:function(){return o},leave:function(){return g},leaveItem:function(){return v},leaveText:function(){return b},leaveTheLine:function(){return y},leaveTheLineText:function(){return m},leftToBuy:function(){return V},ok:function(){return f},otherItem:function(){return M},purchase:function(){return S},purchaseMultiple:function(){return j},purchaseSingle:function(){return k},purchaseTime:function(){return N},queueCtaText:function(){return s},queueDialog:function(){return E},queueItem:function(){return P},remove:function(){return I},stayInLine:function(){return w},timerStartMessage:function(){return h},validItem:function(){return T},viewItem:function(){return c},wait:function(){return A},waitOver:function(){return F},warning:function(){return r},youAreInLine:function(){return O}});var l=t(491288),i=t(626051);const a=e=>"You're in line for "+e.queueTickets+" items",r=()=>"Warning",o=()=>"Hang on, we're getting you in line.",d=()=>"Please don't refresh or leave the line.",s=e=>i.Ys(e.isValid,{true:"Buy",other:"View"}),c=e=>"View the "+e.name,u=()=>"Close banner",m=()=>"Leave the line",x=()=>"Something went wrong. Please try again.",p=()=>"If you leave now, you'll lose your chance to purchase this item.",y=()=>"Leave the line?",f=()=>"Ok",w=()=>"Stay in line",g=()=>"Leave",v=e=>"Leave the line for "+e.name+" ",h=()=>"Complete your purchase before the timer ends.",E=e=>"Once it's your turn, you'll have "+e.queueTime+" minutes to complete your purchase.",L=()=>"Close dialog",b=()=>"Leave",S=()=>"to purchase",V=()=>"left to buy",A=()=>"estimated wait",I=()=>"Remove",C=()=>"Time expired",N=()=>"Less than 2 minutes to purchase",F=()=>"Whoo hoo- the wait is over!",j=()=>"Less than 2 minutes left for 1 or more items",k=()=>"Less than 2 minutes left for 1 item",M=e=>"You're in line for "+e.count+" other "+i.Ho(e.count,0,l.en,{"1":"item",other:"items"}),P=e=>"You're in line for "+e.queueTickets+" "+i.Ho(e.queueTickets,0,l.en,{"1":"item",other:"items"}),T=e=>e.validTickets+" "+i.Ho(e.validTickets,0,l.en,{"1":"item is",other:"items are"})+" ready to buy.",O=()=>"You're in line"},184562:function(e,n,t){t.d(n,{UI:function(){return r},di:function(){return s},q0:function(){return a},sY:function(){return o},xI:function(){return d}});var l=t(949250),i=t(339014);const a=(e,n,t)=>{var a;return{context:t,action:"onClick",name:"leaveLine",payload:{nm:{nm:"leaveLine"},li:{nm:"leaveLine"},ta:n?{ov:"lineDetails"}:{mn:"reservationTimer"},pr:{us:e.customMetadata.item.itemID,qp:(0,i.H)(null===e||void 0===e||null===(a=e.customMetadata)||void 0===a?void 0:a.admissionLikelihood),wt:"pending"===e.state||"paused"===e.state?1e3*(0,l.ok)(e.expectedTurnTimeUnixTimestamp):1e3*(0,l.ok)(e.expires)}}}},r=(e,n,t)=>{var a;return{context:t,action:"onClick",name:"viewItem",payload:{nm:{nm:"viewItem"},li:{nm:"viewItem"},ta:n?{ov:"lineDetails"}:{mn:"queueIt"},pr:{us:e.customMetadata.item.itemID,qp:(0,i.H)(null===e||void 0===e||null===(a=e.customMetadata)||void 0===a?void 0:a.admissionLikelihood),wt:"pending"===e.state||"paused"===e.state?1e3*(0,l.ok)(e.expectedTurnTimeUnixTimestamp):1e3*(0,l.ok)(e.expires)}}}},o=e=>({context:e,action:"onClick",name:"dismiss",payload:{nm:{nm:"dismiss"},li:{nm:"dismiss"},ta:{ov:"lineDetails"}}}),d=e=>({context:e||"queueing",action:"onClick",name:"stayInLine",payload:{nm:{nm:"stayInLine"},li:{nm:"stayInLine"},ta:{ov:"leaveLineConfirm",pt:e||"waitingRoom"}}}),s=e=>({context:e||"queueing",action:"onClick",name:"dismiss",payload:{nm:{nm:"dismiss"},li:{nm:"dismiss"},ta:{ov:"leaveLineConfirm",pt:e||"waitingRoom"}}})},258827:function(e,n,t){t.d(n,{i:function(){return m}});var l=t(512142),i=t(702802),a=t(217091),r=t(636843),o=t(790291),d=t(693271),s=t(969538),c=t(184562),u=t(309513);const m=()=>{var e;const n=null===(e=(0,i.iC)(l.YL).shared.values)||void 0===e?void 0:e.enableQueueSizeIncrease,{pageTitle:t}=(0,s.useContext)(r.z1),{0:m,1:x}=(0,s.useState)(!1),{0:p,1:y}=(0,s.useState)(null),{0:f,1:w}=(0,s.useState)(!1),{queueError:g,removeTicketByQueueValue:v,activeTicketsByExpiryTime:h,isErrorInQueueTickets:E,displayedQueueTicket:L}=(0,o.B)(),b=(0,a.wG)(),S=Boolean(g)||E,V=(e,n)=>{"error"!==e.state&&b((0,c.q0)(e,n,t)),y(e)},A=()=>{b((0,c.di)(t)),y(null)},[I,{status:C}]=(0,d.p)({onSuccess:(e,n)=>{v(n),A()},onError:()=>{w(!0)}}),N=()=>x(!0),F={isError:f,isLeaveDialogueLoading:"loading"===C,onDismissError:()=>w(!1),queueError:g,onConfirmLeaveQueue:async e=>{await I(e.queue)},onCloseLeaveQueue:A,onStayInLine:()=>{b((0,c.xI)(t)),y(null)},onOpenLeaveQueueDialog:V,onCloseQueueDialog:()=>{b((0,c.sY)(t)),x(!1)},displayedQueueTicket:L,queueTickets:h,isQueueDialogOpen:m,ticketToLeave:p,shouldRenderError:S};return L?{...F,...(0,u.Z)(L,{onOpenLeaveQueueDialog:V},t),footerProps:(0,u.u)(n,h,{onOpenQueueDialog:N})}:F}},338001:function(e,n,t){t.d(n,{Z:function(){return T}});var l=t(247687),i=t(283714),a=t(607651),r=t(324523),o=t.n(r),d=t(969538),s=t(409506),c=t(194131),u=t(217091),m=t(636843),x=t(558495),p=t(679670),y=t(949250),f=t(339014),w=t(309513),g=t(258827);const v=(e,n)=>{const t=(0,w.Z)(e,{onOpenLeaveQueueDialog:n},""),{timerProps:l}=t,{name:i}=e.customMetadata.item;if(l){const e=l.endTime&&(0,y.ok)(l.endTime.getTime());return void 0===e?{valid:!1,alert:!1,message:"",timeRemaining:0,name:""}:"valid"===l.ticketState&&0===e?{valid:!0,alert:!0,message:"Time Expired to buy \" ".concat(i),timeRemaining:e,name:i}:e&&"valid"===l.ticketState&&e<300?{valid:!0,alert:!1,message:"".concat(h(e)," left to buy ").concat(i),timeRemaining:e,name:i}:e&&"valid"===l.ticketState&&300===e?{valid:!0,alert:!0,message:"".concat(h(e)," left to buy ").concat(i),timeRemaining:e,name:i}:{valid:!1,alert:!1,message:"",timeRemaining:0,name:i}}return{valid:!1,alert:!1,message:"",timeRemaining:0,name:""}},h=e=>{const n=Math.floor(e/60),t=e%60;return n>=1?"".concat(n,":").concat(t.toString().padStart(2,"0")," minutes"):"".concat(t," seconds")};var E=t(689221),L=t(22769),b=t(48555);const S=e=>{let{onClose:n,titleId:t,title:i}=e;return(0,l.jsxs)("div",{className:"white items-center flex flex-row-reverse justify-between ph4 pv3",children:[(0,l.jsx)("button",{"aria-label":(0,E.m)(b,"closeDialog"),className:"bg-dark-blue pa0 white bn pointer h1",onClick:n,children:(0,l.jsx)(L.J,{name:"Close",size:"medium"})}),(0,l.jsx)("h2",{id:t,className:"f3 mv0",children:i})]})};var V=t(147507),A=t(410904);const I=(0,E.m)(b,"errorMessage"),C=(0,E.m)(b,"defaultMessage"),N=e=>{let{isError:n,isLeaveDialogueLoading:t,isOpen:i,onClose:a,onStayInLine:r,onDismissError:o,onLeaveQueue:s}=e;const{pageTitle:c}=(0,d.useContext)(m.z1),y=(0,u.wG)();return(0,d.useEffect)(()=>{i&&y({context:c||"queueing",action:"overlayView",name:"leaveLineConfirm",payload:{nm:{nm:"leaveLineConfirm"},ta:{ov:"leaveLineConfirm",pt:c||"waitingRoom"}}})},[i,y,c]),(0,l.jsx)(x.Z,{children:(0,l.jsx)(p.Z,{title:(0,E.m)(b,"leaveTheLine"),isOpen:i,onClose:a,size:"small",actions:n?(0,l.jsx)("div",{className:"flex flex-column flex-row-reverse-m w-100 w-auto-m",children:(0,l.jsx)(V.Z,{className:"mt4 pv0 f6-m pv2-m mt0-m",onClick:o,variant:"primary",children:(0,E.m)(b,"ok")})}):(0,l.jsx)("div",{className:"flex flex-column flex-row-reverse-m w-100 w-auto-m",children:t?(0,l.jsx)(A.$,{color:"gray",size:"small",UNSAFE_className:"tc"}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(V.Z,{variant:"primary",isFullWidth:!0,onClick:r,className:"f6-m",children:(0,E.m)(b,"stayInLine")}),(0,l.jsx)(V.Z,{className:"mt4 pv0 f6-m pv2-m mt0-m",isFullWidth:!0,onClick:s,variant:"tertiary",children:(0,E.m)(b,"leave")})]})}),children:(0,l.jsx)("p",{className:"mv0 dark-gray tc f6 f5-m tl-m lh-copy",children:n?I:C})})})};N.DEFAULT_MESSAGE=C,N.ERROR_MESSAGE=I;var F=t(820038),j=t(329359);var k=t(530090);const M=e=>{let{className:n,children:t,float:r,isQueueDialogOpen:d}=e;const s=(0,a.M)(),{asPath:c}=(0,i.tv)().router,u=c.includes("/cart"),m=c.includes("/checkout"),x=r?P(s,c,d?"hidden":"visible",n):{className:o()("bg-dark-blue white",{"br3 br--top":!s&&(u||m),"nl3 nr3":!u&&!m},n),style:{padding:"1px",marginBottom:s?"18px":"inherit"}};return(0,l.jsx)("div",{...x,"data-testid":"queue-banner",children:t})},P=(e,n,t,l)=>{const i="fixed z-1 bg-dark-blue",a=n.includes("/ip");return e?{className:o()(i,"w-100 left-0 right-0",l),style:{bottom:a?"72px":"0",visibility:t}}:{className:o()(i,"br2 overflow-hidden shadow-3",l),style:{bottom:"24px",left:"24px",width:"400px",visibility:t}}};M.Body=e=>{let{children:n,isQueueDialog:t,onClick:a,text:r,queueTicket:d,className:s}=e;const{isMobile:u}=(0,c.vP)(),{asPath:m}=(0,i.tv)().router,x=m.includes("/cart"),p=m.includes("/checkout");return(0,l.jsxs)("div",{className:o()("flex",x||p?"bg-transparent":"bg-white br2 shadow-2",t?"mb3 pa3 br3 flex-column":"ma2 items-center",s),children:[n,a&&(!p||p&&u)&&(r?(0,l.jsx)(V.Z,{className:o()("h2",{"ml-auto":!t,"w-20 mb3 nt4 ml2":t}),onClick:a,variant:"tertiary","aria-label":(null===d||void 0===d?void 0:d.customMetadata.item.name)?(0,E.m)(b,"leaveItem",{name:null===d||void 0===d?void 0:d.customMetadata.item.name}):r,children:t?(0,E.m)(b,"leaveTheLineText"):r}):(0,l.jsx)(V.Z,{"aria-label":(0,E.m)(b,"closeBanner"),className:o()("bg-transparent bn h2 pb0 pointer pt0 self-center w3 ml-auto grey"),onClick:a,type:"button",useLDButton:!1,children:(0,l.jsx)(L.J,{className:"v-btm",name:"Close"})}))]})},M.Cta=e=>{let{onClick:n,isQueueDialog:t,queueTicket:i,className:a}=e;var r,d,s,c;const u="valid"===(null===i||void 0===i?void 0:i.state),m=u?null===i||void 0===i||null===(r=i.customMetadata)||void 0===r||null===(d=r.viewItemCtaLabel)||void 0===d?void 0:d.valid:null===i||void 0===i||null===(s=i.customMetadata)||void 0===s||null===(c=s.viewItemCtaLabel)||void 0===c?void 0:c.pending;return(0,l.jsx)(V.Z,{className:o()("".concat(t&&"flex self-end"),a),onClick:n,size:"small",variant:"".concat(t?"secondary":"tertiary"),"aria-label":(0,E.m)(b,"viewItem",{name:null===i||void 0===i?void 0:i.customMetadata.item.name}),children:m||(0,E.m)(b,"queueCtaText",{isValid:u})})},M.Image=e=>{let{className:n,isQueueDialog:t,isQueueFooterOpen:i,src:a,height:r,width:d,name:s}=e;const{isMobile:u}=(0,c.vP)(),{imageHeight:m,imageWidth:x}={imageHeight:(p={src:a,height:r,width:d}).height||40,imageWidth:p.width||40};var p;const y=(0,F.P)({src:a,height:m.toString(),width:x.toString()});return(0,l.jsx)("div",{className:o()("br2 overflow-hidden",{mr2:t},n),style:{maxWidth:x,maxHeight:m},children:(0,l.jsx)(j.Z,{alt:s,"data-testid":"queue-product-image",preload:!0,loading:"eager",src:y,srcSet:"".concat(y," 1x, ").concat(y," 2x"),height:"auto",width:"auto"})})},M.Dialog=e=>{let{children:n,isOpen:t,onClose:i,title:a,queueTickets:r}=e;const{pageTitle:o}=(0,d.useContext)(m.z1),{isMobile:w}=(0,c.vP)(),h=(0,u.wG)(),{TimerAnnouce:E}=(e=>{const{onOpenLeaveQueueDialog:n}=(0,g.i)(),t=e.map(e=>v(e,n)).filter(e=>e.valid).sort((e,n)=>e.timeRemaining-n.timeRemaining);return{TimerAnnouce:()=>{return 1===t.length?{alert:t[0].alert,message:t[0].message}:t.length>1?{alert:t[0].alert,message:"".concat(t[0].message,", ").concat((e=t.length-1,"".concat(e,1===e?" other item":" other items"))," will expire in less than 5 mins.")}:{alert:!1,message:""};var e}}})(r),{alert:L,message:b}=E();(0,d.useEffect)(()=>{if(t){const e=null===r||void 0===r?void 0:r.map(e=>{var n,t,l;return{us:null===e||void 0===e||null===(n=e.customMetadata)||void 0===n||null===(t=n.item)||void 0===t?void 0:t.itemID,qp:(0,f.H)(null===e||void 0===e||null===(l=e.customMetadata)||void 0===l?void 0:l.admissionLikelihood),wt:"pending"===e.state||"paused"===e.state?1e3*(0,y.ok)(null===e||void 0===e?void 0:e.expectedTurnTimeUnixTimestamp):1e3*(0,y.ok)(null===e||void 0===e?void 0:e.expires)}});h({context:o,action:"overlayView",name:"lineDetails",payload:{nm:{nm:"lineDetails"},pr:e}})}},[t,r,o,h]),(0,d.useEffect)(()=>{t&&setTimeout(()=>{const e=document.querySelector(".item-queue-bg div[role=\"dialog\"]");e&&e.classList.add("bg-dark-blue","scrollbar-queue-panel")},50)},[t]);const V=L?(0,l.jsx)(s.VisuallyHidden,{role:"alert","aria-live":"assertive",children:b}):(0,l.jsx)(s.VisuallyHidden,{"aria-live":"off",children:b});return(0,l.jsx)(x.Z,{children:(0,l.jsx)(p.Z,{closeButtonProps:{UNSAFE_className:"white"},title:w?(0,l.jsxs)(l.Fragment,{children:[V,(0,l.jsx)("span",{className:"white",children:a})]}):e=>{let{titleId:n}=e;return(0,l.jsxs)(l.Fragment,{children:[V,(0,l.jsx)(S,{title:a,onClose:i,titleId:n}),(0,l.jsx)(s.Divider,{})]})},isOpen:t,onClose:i,position:"right",desktopComponent:"panel",size:"medium",className:"item-queue-bg",children:n})})},M.Error=()=>(0,l.jsxs)("div",{className:"flex ma3 mv5-m","data-testid":"queue-error-banner",children:[(0,l.jsx)(L.J,{name:"Warning",size:"small",className:"gold mr2"}),(0,l.jsx)("p",{className:"f6 ma0 white lh-copy",children:"".concat((0,E.m)(b,"hangOn")," ").concat((0,E.m)(b,"dontRefresh"))})]}),M.LeaveQueueDialog=N,M.Footer=e=>{let{message:n,onClick:t}=e;return(0,l.jsx)("div",{className:"flex white items-start f6 justify-between items-center b--white ma2","data-testid":"queue-banner-footer",children:t&&(0,l.jsxs)(V.Z,{"aria-label":n,className:"white no-underline pr0 h1 justify-between w-100 pl0",onClick:t,variant:"tertiary",UNSAFE_style:{color:"white"},children:[(0,l.jsx)("span",{children:n}),(0,l.jsx)(L.J,{name:"ChevronRight",size:"small"})]})})},M.Timer=e=>{const{asPath:n}=(0,i.tv)().router,t=n.includes("/ip"),a=n.includes("/cart"),r=n.includes("/checkout");return(0,l.jsx)("div",{className:"".concat((t||a||r)&&"ml2"),children:(0,l.jsx)(k.w,{...e})})},M.TimerMessage=e=>{let{className:n,isQueueDialog:t,message:a}=e;const{asPath:r}=(0,i.tv)().router,d=r.includes("/cart"),s=r.includes("/checkout");return(0,l.jsx)("p",{className:o()("f6 ml2",{black:!t,ma0:t,white:d||s},n),children:a})};var T=M},309513:function(e,n,t){t.d(n,{Z:function(){return o},u:function(){return d}});var l=t(689221),i=t(367250),a=t(48555),r=t(184562);const o=(e,n,t)=>{let{onOpenLeaveQueueDialog:o}=n;return"valid"===e.state?{leaveQueueProps:{text:(0,l.m)(a,"leaveText"),onClick:o},timerProps:{endTime:s(e.expires),message:(0,l.m)(a,"leftToBuy"),ticketState:e.state},ctaProps:{onClick:(n,l,i)=>()=>{l((0,r.UI)(e,i,t)),n(e.customMetadata.item.itemURL)}}}:"pending"===e.state||"paused"===e.state?{leaveQueueProps:{text:(0,l.m)(a,"leaveText"),onClick:o},timerProps:{endTime:s(e.expectedTurnTimeUnixTimestamp),message:(0,l.m)(a,"wait"),ticketState:e.state},ctaProps:{onClick:(n,l,a)=>()=>{l((0,r.UI)(e,a,t)),n((0,i.$)(e))}}}:"error"===e.state&&"TICKET_EXPIRED"===e.errorCode?{leaveQueueProps:{text:(0,l.m)(a,"remove"),onClick:o},timerProps:{message:(0,l.m)(a,"expired"),ticketState:e.state}}:{}},d=(e,n,t)=>{let{onOpenQueueDialog:i}=t;const r=n.length,o=n.filter(e=>"valid"===e.state).length,d=(0,l.m)(a,"queueItem",{queueTickets:r}),s=(0,l.m)(a,"validItem",{validTickets:o});if(!(r<2)){if(e)return{message:"".concat(d).concat(o>0?". ".concat(s):""),onClick:i};{const e=r-1;return{message:(0,l.m)(a,"otherItem",{count:e}),onClick:i}}}},s=e=>new Date(e)},693271:function(e,n,t){t.d(n,{p:function(){return s}});var l=t(217091),i=t(636843),a=t(890003),r=t(168796),o=t(969538),d=t(51906);const s=e=>{const{pageTitle:n}=(0,o.useContext)(i.z1),t=(0,a.Z)(),s=(0,l.wG)(),c=null===e||void 0===e?void 0:e.onSuccess,u=null===e||void 0===e?void 0:e.onError;return(0,r.D)(e=>(0,d.Ch)(t,"discardTicket",e),{onSuccess:(e,t,l)=>{s({context:n||"queueing",action:"onClick",name:"leaveLine",payload:{nm:{nm:"leaveLine"},li:{nm:"leaveLine"},ta:{ov:"leaveLineConfirm",pt:n||"waitingRoom"}}}),null===c||void 0===c||c(e,t,l)},onError:function(){for(var e=arguments.length,t=new Array(e),l=0;l<e;l++)t[l]=arguments[l];s({context:n||"queueing",action:"onClick",name:"leaveLine",payload:{nm:{nm:"error"},li:{nm:"leaveLine"},ta:{ov:"leaveLineConfirm",pt:n||"waitingRoom"}}}),null===u||void 0===u||u(...t)}})}},790291:function(e,n,t){t.d(n,{B:function(){return a}});var l=t(969538),i=t(705387);const a=()=>{const{error:e,itemQueueData:n,setItemQueueData:t,...a}=(()=>{const e=(0,l.useContext)(i.e);if(!e)throw new Error("useQueueContext must be used within ItemQueueContextProvider");return e})(),r=(0,l.useCallback)(e=>{Array.isArray(e)?null===t||void 0===t||t(e):null===t||void 0===t||t([...n,e])},[n,t]),o=(0,l.useCallback)(e=>{const t=n.filter(n=>n.queue!==e);r(t)},[n,r]);return{...a,queueData:n,queueError:e,removeTicketByQueueValue:o,setQueueData:t,updateQueueData:r}}},339014:function(e,n,t){t.d(n,{H:function(){return l}});const l=e=>"guaranteed"===e?"1":"likely"===e?"2":"3"}}]);