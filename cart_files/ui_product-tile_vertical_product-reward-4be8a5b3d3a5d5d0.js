"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[16987],{420255:function(e,a,t){t.d(a,{V:function(){return J}});var i=t(247687),s=t(512142),r=t(409506),n=t(702802),l=t(689221),o=t(217091),d=t(283714),c=t(252025),m=t(17917),u=t(168796);const h={type:"mutation",name:"clipRewardPromotionEngine",hash:"a8dc7824835bc1872e6fade3fadc9a95386447db8d8d79ef617abd5e420df4d0"};var x=t(737957),v=t(969538),w=t(923181);var f=t(324523),C=t.n(f);const g=(e,a,t,i,s)=>C()("pa1 pr3 br2 relative z-1 ".concat(i," ").concat(e===x.J.CLIPPED||e===x.J.APPLIED||a&&e===x.J.UNCLIPPED?"":s?"product-border":"b--navy ba","\n    ").concat(t?"":"dib","\n    ").concat(a?"bg-near-white-blue":s?"product-background":"bg-washed-blue"));var p=t(976363),k=t(198552),b=t(147507),j=t(437846),y=t(22769);const S=e=>{let{baseClass:a,iconName:t,iconSize:s,iconClass:r,textClass:n,textMessage:l}=e;return(0,i.jsxs)("div",{className:a,children:[t&&(0,i.jsx)(y.J,{name:t,size:s,className:r,"aria-hidden":!0}),(0,i.jsx)("span",{className:n,children:l})]})};var L=t(329359);const N=e=>{let{baseClass:a,src:t,alt:s,width:r,height:n,preload:l,fetchPriority:o,imageClass:d,textClass:c,textMessage:m}=e;return(0,i.jsxs)("div",{className:a,children:[(0,i.jsx)(L.Z,{src:t,alt:s,width:r,height:n,preload:l,fetchPriority:o,className:d}),(0,i.jsx)("span",{className:c,children:m})]})},R=e=>{let{conditionalStr:a,ctaChildren:t,CTALinkExtras:s,eventMultiplierStr:r,fullWidth:n,href:o,item:d,restriction:c,restrictionTextStyle:m,rewardAppliedMessage:u,rewardAvailableMessage:h,rewardStateWithoutContext:v,showMultiLineRestriction:f,signIn:g,enableProductRewardStyleUpdate:p}=e;const{authState:{isLoggedIn:y}}=(0,k.Eu)(),L=(0,i.jsx)(b.Z,{"data-dca-id":"ui_product_tile:product_reward_applied_available:button","data-dca-intent":"variantClick","data-dca-name":"ItemBuyBoxSignInToClaimWalmartRewardButton",href:o,variant:"tertiary",size:"medium",className:C()("f6 pa0 h-auto",n?"ml-auto":"ml5"),onLinkName:"signInToClaimWalmartReward",onLinkExtras:s,style:{whiteSpace:"inherit"},onClick:e=>{e.preventDefault(),null===g||void 0===g||g()},children:t});return(0,i.jsx)("div",{children:v===x.J.APPLIED?(0,i.jsx)(S,{baseClass:"flex items-center",iconName:"MoneyCircleFill",iconSize:"small",iconClass:"navy",textClass:"f7 navy b ml1 lh-solid",textMessage:u}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:C()("flex",{"flex-column items-start":!n}),children:[p?(0,i.jsx)(N,{baseClass:"flex items-center",src:j.OC,preload:!0,height:y?j.QA:j.X$,width:y?j.ob:j.Ke,alt:(0,l.m)(w,"cashLogo"),textClass:"f7 navy b ml1",textMessage:h}):(0,i.jsx)(S,{baseClass:"flex items-center",iconName:"MoneyCircleFill",iconSize:y?"small":"medium",iconClass:"navy",textClass:"f7 navy b ml1",textMessage:h}),!y&&n&&L]}),(0,i.jsx)("div",{className:C()("sans-serif f7 gray"),style:m||{marginLeft:30},id:"add-walmart-reward".concat(null===d||void 0===d?void 0:d.id),children:f?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{children:r}),(0,i.jsx)("div",{children:c})]}):a||""}),!y&&!n&&L]})})};var I=t(76993);const P=t.n(I)()((()=>t.e(4024).then(t.bind(t,147607))),{loadableGenerated:{webpack:()=>[147607]},ssr:!1}),M=e=>{let{setShowErrorModal:a,sorryTextMessage:t}=e;const s=()=>{a(!1)};return(0,i.jsx)(P,{actions:(0,i.jsx)("div",{className:"center",children:(0,i.jsx)(b.Z,{className:"mb2",onClick:s,variant:"primary",size:"medium",onLinkName:"errorModalOk",children:(0,l.m)(w,"ok")})}),isOpen:!0,onClose:s,size:"small",title:(0,l.m)(w,"manufacturerOffersTitle"),children:(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"b",children:t}),(0,l.m)(w,"tryAgain")]})})};var A=t(372448),T=t(435760),E=t(970718);const W=e=>{let{rewardStateWithoutContext:a,setRewardState:t,setRewardStateWithoutContext:s,rewardAmt:r,savedRewardsMessage:n,offer:o,secondaryText:d,onToggleCheckbox:c,onClipRewardClick:m,preventDefaultClipHandler:u,clipRewardPromotion:h,item:f,onLinkExtras:g,isDisabled:p,showDetails:k,onClickDetails:j,showMultiLineRestriction:L,eventMultiplierStr:N,restriction:R,offerId:I,selectionToken:P,usItemId:M,secondaryPrefix:W,detailsButtonADAText:D,checkBoxADAText:_,restrictionTextStyle:B,conditionalStr:J,checkboxCustomClassName:z}=e;const{0:O,1:U}=(0,v.useState)(!1),Z={...g,li:{ath:{athAssest:(0,A.OI)(null===f||void 0===f?void 0:f.canonicalUrl)}}},F=()=>{(0,T.c)("digitalRewardsClick",Date.now().toString()),t&&t(x.J.CLIPPED),U(!0),s(x.J.CLIPPED),g&&g.pr&&(g.pr.wd="1"),m&&m(f),u||h({input:{cbOffer:"".concat(I),selectionToken:P,usItemId:M||(null===f||void 0===f?void 0:f.usItemId)}}),c&&c()},K=a===x.J.CLIPPED,H=o&&!K&&!k&&!p;return(0,i.jsxs)("div",{className:C()({pointer:H}),...H&&{onClick:F},children:[(0,i.jsxs)("div",{className:"flex items-center",...K&&O&&{role:"alert"},children:[K?(0,i.jsx)(S,{iconName:"Check",iconSize:"medium",textClass:"f7 navy b ml1",textMessage:r?"$".concat(r.toFixed(2)," ").concat(n):n}):o&&(0,i.jsx)(E.Z,{"data-dca-id":"ui_product_tile:product_reward_toggle_clip:checkbox","data-dca-intent":"variantClick","data-dca-name":"ItemBuyBoxaddWalmartReward",label:o,onChange:k?F:()=>{},onLinkName:"addWalmartReward",onLinkExtras:f?Z:g,"aria-label":_||"".concat(o," ").concat((0,l.m)(w,"walmartPlus"),", ").concat(d),className:z||"f7 navy b lh-title",disabled:p,checkboxProps:{"aria-describedby":"add-walmart-reward".concat(null===f||void 0===f?void 0:f.id)}}),k&&!p&&(0,i.jsx)(b.Z,{"data-dca-id":"ui_product_tile:product_reward_toggle_clip:button","data-dca-intent":"variantClick","data-dca-name":"ItemBuyBoxShowRewardDetailsButton",onClick:j,onLinkName:"showRewardDetails","aria-label":D||(0,l.m)(w,"showRewardDetails"),variant:"tertiary",size:"small",className:"bn pa0 no-underline ml2 h-inherit flex",disabled:p,children:(0,i.jsx)(y.J,{name:"InfoCircle",size:"small","aria-hidden":!0})})]}),(0,i.jsx)("div",{className:C()("sans-serif f7 dark-gray"),style:B||{marginLeft:30},id:"add-walmart-reward".concat((null===f||void 0===f?void 0:f.id)||I),children:L?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{children:N}),(0,i.jsx)("div",{children:R})]}):J||""}),d&&(0,i.jsxs)("div",{className:"flex items-center mt1 mb2",style:{marginLeft:30},children:[W&&(0,i.jsx)(W,{}),(0,i.jsx)("span",{className:C()("f7 b ml2",{"dark-gray":p,blue:!p}),children:d})]})]})},D=e=>{let{conditionalStr:a,ctaChildren:t,CTALinkExtras:s,eventMultiplierStr:r,fullWidth:n,href:l,item:o,restriction:d,restrictionTextStyle:c,showMultiLineRestriction:m,signIn:u,unlockRewardIcon:h,unlockRewardMessage:x}=e;const v=(0,i.jsx)(b.Z,{href:l,variant:"tertiary",size:"medium",className:C()("f6 pa0 h-auto",n?"ml-auto":"ml5"),onLinkName:"signInToClaimWalmartReward",onLinkExtras:s,style:{whiteSpace:"inherit"},onClick:e=>{e.preventDefault(),null===u||void 0===u||u()},children:t});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:C()("flex",{"flex-column items-start":!n}),children:[(0,i.jsx)(S,{baseClass:"flex items-center",iconName:h,iconSize:"medium",iconClass:"navy",textClass:"f7 navy b ml1",textMessage:x}),n&&v]}),(0,i.jsx)("div",{className:C()("sans-serif f7 gray"),style:c||{marginLeft:30},id:"add-walmart-reward".concat(null===o||void 0===o?void 0:o.id),children:m?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{children:r}),(0,i.jsx)("div",{children:d})]}):a||""}),!n&&v]})},_=e=>{let{fullWidth:a,hideUnlockRewardIcon:t,unlockRewardIcon:s,unlockEarnRewardMessage:r,hideWalmartPlusBlueLogo:n,joinWPlusLinkExtras:o,joinWplus:d,ctaJoinWPlusChildren:c,secondaryText:m}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:C()("flex",{"flex-column items-start":!a}),children:[(0,i.jsxs)("div",{className:"flex items-center",children:[t?(0,i.jsx)(L.Z,{src:j.Xi,preload:!0,height:24,width:24,alt:(0,l.m)(w,"walmartPlus")}):s&&(0,i.jsx)(y.J,{name:s,size:"medium",className:"blue","aria-hidden":!0}),(0,i.jsx)("div",{className:"f7 navy b ml1",children:r}),!n&&a&&(0,i.jsx)(L.Z,{src:j.hE,alt:(0,l.m)(w,"walmartPlus"),preload:!1,width:54,height:18,"aria-hidden":!0,className:"ml1 mt1"})]}),(0,i.jsx)(b.Z,{variant:"tertiary",size:"medium",className:C()("f6 pa0 h-auto",a?"ml-auto":"ml5"),onLinkName:"joinWalmartPlus","aria-label":(0,l.m)(w,"joinWalmartPlus"),onLinkExtras:o,onClick:d,style:{whiteSpace:"inherit"},children:c})]}),m&&(0,i.jsx)("div",{className:"f7 blue b mt1 mb2 ml5",children:m})]})};var B=t(86150);const J=e=>{let{joinWplus:a,signIn:t,href:f,unlockRewardIcon:C="MoneyCircle",rewardAmt:k,unlockRewardMessage:b="".concat((0,l.m)(w,"unlockReward")),savedRewardsMessage:j="".concat((0,l.m)(w,"rewardAdded")),unlockEarnRewardMessage:y="".concat((0,l.m)(w,"earnReward",{rewardAmt:k})),rewardAppliedMessage:S=(0,l.m)(w,"rewardApplied"),rewardAvailableMessage:L=(0,l.m)(w,"rewardAvailable"),sorryTextMessage:N=(0,l.m)(w,"sorryText"),rewardSavedMessage:I=(0,l.m)(w,"rewardSaved"),hideWalmartPlusBlueLogo:P,detailsButtonADAText:A,hideUnlockRewardIcon:T,ctaChildren:E="".concat((0,l.m)(w,"signIn")),ctaJoinWPlusChildren:J="".concat((0,l.m)(w,"joinWalmartPlus")),item:z,offerId:O,selectionToken:U,offer:Z,state:F,restriction:K="",eventMultiplierStr:H="",enableCashBackRebrand:G=!1,moduleContext:V="",pageTitle:X="",onToggleCheckbox:Y=c.Z,showDetails:$,onClickDetails:q,onClipRewardClick:Q=c.Z,onClipRewardSuccess:ee=c.Z,onLinkExtras:ae={},usItemId:te,joinWPlusLinkExtras:ie,fullWidth:se=!1,secondaryText:re="",secondaryPrefix:ne,isDisabled:le,preventDefaultClipHandler:oe,showMultiLineRestriction:de,checkBoxADAText:ce="",restrictionTextStyle:me,CTALinkExtras:ue,className:he,checkboxCustomClassName:xe}=e;var ve,we;const fe=(0,n.iC)(s.YL),{wmcash:Ce}=(0,n.iC)(B.Y),ge=null===(ve=fe.shared.values)||void 0===ve?void 0:ve.enableProductRewardStyleUpdate,pe=null===Ce||void 0===Ce||null===(we=Ce.values)||void 0===we?void 0:we.enableClaimedOffersOLC,{addSnack:ke}=(0,r.useSnackbar)(),{router:be}=(0,d.tv)(),{rewardState:je,setRewardState:ye}=(0,p.Kf)(),{0:Se,1:Le}=(0,v.useState)(je||F);(0,v.useEffect)((()=>{Le(je||F)}),[je,F]);const{0:Ne,1:Re}=(0,v.useState)(!1),Ie=(0,o.wG)(),{clipRewardPromotion:Pe,error:Me,errors:Ae}=(e=>{const a=(0,m.G)(),[t,{data:i,isError:s}]=(0,u.D)((e=>a(h,e)),e);return{clipRewardPromotion:t,error:Boolean(null===i||void 0===i?void 0:i.errors)||s,errors:null===i||void 0===i?void 0:i.errors}})({onSuccess:(e,a)=>{e.errors||(ee(a),ke({message:pe?(0,l.m)(w,"rewardItemSavedMessage2"):I,actionButtonProps:{children:(0,l.m)(w,pe?"viewAll":"viewList"),onClick:()=>{be.push(pe?"/offer/claimed-offers":"/lists/RL/saved-rewards")}}}))}}),Te=((e,a,t)=>{let i="",s="",r="",n="";return a?(s="".concat(t?"".concat((0,l.m)(w,"manufacturerOffer")," | "):(0,l.m)(w,"manufacturerOffer")),r="",n="".concat(t).slice("".concat(t).indexOf(" "))):(s="",r=e&&t?"".concat(e," - "):e,n="".concat(t?"".concat(t):"")),i=i.concat(s,r,n).trimStart(),i})(H,G,K);if((0,v.useEffect)((()=>{var e,a,t,i,s,r,n,l;Me&&(Ie({context:V,name:"error",action:"error",payload:{er:{rn:Ae&&(null===(e=Ae[0])||void 0===e||null===(a=e.extensions)||void 0===a?void 0:a.code),ms:Ae&&(null===(t=Ae[0])||void 0===t?void 0:t.message),dt:Ae&&(null===(i=Ae[0])||void 0===i||null===(s=i.extensions)||void 0===s||null===(r=s.exception)||void 0===r?void 0:r.message),ec:Ae&&(null===(n=Ae[0])||void 0===n||null===(l=n.extensions)||void 0===l?void 0:l.status)},ta:{pt:X}}}),Re(!0))}),[Me,Ie,Ae,V,X]),Se===x.J.UNKNOWN)return null;const Ee=z?z.usItemId:"NullUsItemId";return(0,i.jsxs)(i.Fragment,{children:[!Me&&(0,i.jsx)("div",{className:"mt2 mb2",children:(0,i.jsxs)("div",{"data-testid":"qa-id-walmartReward-".concat(Ee),className:g(Se,le,se,he,ge),children:[(Se===x.J.UNCLIPPED||Se===x.J.CLIPPED)&&(0,i.jsx)(W,{rewardStateWithoutContext:Se,setRewardState:ye,setRewardStateWithoutContext:Le,rewardAmt:k,savedRewardsMessage:j,offer:Z,secondaryText:re,onToggleCheckbox:Y,onClipRewardClick:Q,preventDefaultClipHandler:oe,clipRewardPromotion:Pe,item:z,onLinkExtras:ae,isDisabled:le,showDetails:$,onClickDetails:q,showMultiLineRestriction:de,eventMultiplierStr:H,restriction:K,offerId:O,selectionToken:U,usItemId:te,secondaryPrefix:ne,detailsButtonADAText:A,checkBoxADAText:ce,restrictionTextStyle:me,conditionalStr:Te,checkboxCustomClassName:xe}),(Se===x.J.APPLIED||Se===x.J.AVAILABLE)&&(0,i.jsx)(R,{rewardStateWithoutContext:Se,rewardAppliedMessage:S,rewardAvailableMessage:L,href:f,signIn:t,ctaChildren:E,CTALinkExtras:ue,restriction:K,restrictionTextStyle:me,item:z,showMultiLineRestriction:de,eventMultiplierStr:H,conditionalStr:Te,fullWidth:se,enableProductRewardStyleUpdate:ge}),Se===x.J.UNLOCK&&(0,i.jsx)(D,{fullWidth:se,unlockRewardIcon:C,unlockRewardMessage:b,href:f,signIn:t,ctaChildren:E,CTALinkExtras:ue,restriction:K,restrictionTextStyle:me,item:z,showMultiLineRestriction:de,eventMultiplierStr:H,conditionalStr:Te}),Se===x.J.UNLOCK_WITH_W_PLUS&&(0,i.jsx)(_,{fullWidth:se,hideUnlockRewardIcon:T,unlockRewardIcon:C,unlockEarnRewardMessage:y,hideWalmartPlusBlueLogo:P,joinWPlusLinkExtras:ie,joinWplus:a,ctaJoinWPlusChildren:J,secondaryText:re})]})}),Ne&&(0,i.jsx)(M,{setShowErrorModal:Re,sorryTextMessage:N})]})}}}]);